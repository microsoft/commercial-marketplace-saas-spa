<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no" />
  <title>
    Microsoft Commercial Marketplace sample with SPA and Azure Function Apps
  </title>
  <link rel="SHORTCUT ICON" href="./favicon.svg" type="image/x-icon" />

  <!-- msal.min.js can be used in the place of msal.js; included msal.js to make debug easy -->
  <!-- <script type="text/javascript" src="https://alcdn.msauth.net/browser/2.8.0/js/msal-browser.min.js" integrity="sha384-Mjsbb/z4VVY/1KEUcSY4zG2SObmLbGdEQp1a6qJ8x4Qkd8HqhBmkigPO1LO+ZKC8" crossorigin="anonymous"></script> -->
  <script type="text/javascript" src="https://alcdn.msauth.net/browser/2.8.0/js/msal-browser.min.js"></script>

  <!-- adding Bootstrap 4 for UI components  -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
    integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous" />
</head>

<body>
  <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <a class="navbar-brand" href="/">Contoso</a>
    <div class="btn-group ml-auto dropleft">
      <button type="button" id="signIn" class="btn btn-secondary" onclick="signIn()">
        Sign In
      </button>
      <button type="button" id="signOut" class="btn btn-success d-none" onclick="signOut()">
        Sign Out
      </button>
    </div>
  </nav>
  <br />
  <h5 class="card-header text-center">
    Marketplace SPA Sample
  </h5>
  <br />
  <div class="row" style="margin: auto">
    <div id="card-div" class="col-md-6" style="display: none">
      <div class="card text-center">
        <div class="card-body">
          <h5 class="card-title" id="welcomeMessage">
            Please sign-in to see your profile
          </h5>
          <div id="claims-div" style="display:none">
            <h5>Details from the claims</h5>
          </div>

          <div id="profile-div" style="display:none">
            <h5>Details from the Graph API</h5>
            <p>Please note the user principal name (upn) may not be a real email address. Always retrieve the email address from the "mail" property on the user object. If mail property is empty, you may want to ask the user to provide the contact email.</p>
          </div>

        </div>
      </div>

    </div>
    <div id="resolve-card" class="col-md-6">
      <div class="card text-center">
        <div class="card-body">
          <h5 class="card-title">
            Result from the Marketplace RESOLVE call
          </h5>
          <div id="resolve-div" style="display: none">
          </div>
          <div id="token-div" style="display: none" >
            <p>
              Go to a SaaS subscription you have access to, and access the landing page for the solution. Copy the value of the token parameter on the URL, paste below and click the button to refresh.
            </p>
            <label for="token-input">Token:</label>
            <input type="text" id="token-input">
            <br><br>
            <button  type="button" id="reloadWithTokenButton" onclick="reloadWithToken()">Append token</button> 
          </div>
        </div>
      </div>
    </div>

  </div>

  <!-- importing bootstrap.js and supporting js libraries -->
  <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
    integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n"
    crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
    integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
    crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"
    integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV"
    crossorigin="anonymous"></script>

  <!-- importing app scripts (load order is important) -->
  <script type="text/javascript" src="./authConfig.js"></script>
  <script type="text/javascript" src="./ui.js"></script>

  <script type="text/javascript" src="./auth.js"></script>
</body>

</html>